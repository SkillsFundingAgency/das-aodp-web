using System;
using System.Collections.Generic;
using System.Linq;
namespace SFA.DAS.AODP.Infrastructure.File
{
    public static class MalwareScanStatusExtensions
    {
        public static bool IsDownloadAllowed(this MalwareScanStatus status) =>
            status == MalwareScanStatus.Clean;

        public static string ToUserFacingText(this MalwareScanStatus status) => status switch
        {
            MalwareScanStatus.Clean => "Security scan passed",
            MalwareScanStatus.InProgress => "Security scan in progress",
            MalwareScanStatus.Unknown => "Security scan pending",
            MalwareScanStatus.Malicious => "Blocked (failed security scan)",
            MalwareScanStatus.Error => "Blocked (scan error)",
            _ => "Security scan pending"
        };
    }
}
